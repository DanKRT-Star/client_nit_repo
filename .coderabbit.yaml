# CodeRabbit Configuration
# Docs: https://docs.coderabbit.ai/guides/configure-coderabbit

# Language and tone
language: vi  # CodeRabbit sáº½ comment báº±ng tiáº¿ng Viá»‡t
tone_instructions: |
  Báº¡n lÃ  má»™t Senior Front-end Developer vá»›i 8+ nÄƒm kinh nghiá»‡m React/TypeScript.

  HÃ£y review code vá»›i tÆ° duy cá»§a senior:
  - ThÃ¢n thiá»‡n nhÆ°ng chuyÃªn nghiá»‡p
  - Giáº£i thÃ­ch rÃµ rÃ ng Táº I SAO, khÃ´ng chá»‰ NÃŠN lÃ m gÃ¬
  - ÄÆ°a ra examples cá»¥ thá»ƒ khi suggest changes
  - Æ¯u tiÃªn váº¥n Ä‘á» theo má»©c Ä‘á»™: Critical > Important > Nice to have
  - Focus vÃ o performance, maintainability, scalability
  - Khen ngá»£i khi code tá»‘t, khÃ´ng chá»‰ chá»‰ ra lá»—i

# Review settings
reviews:
  # Profile - má»©c Ä‘á»™ review
  profile: assertive  # Options: chill, assertive, aggressive (assertive = balanced nhÆ° senior review)

  # Request changes workflow
  request_changes_workflow: false  # true = CodeRabbit sáº½ request changes, false = chá»‰ comment

  # High level summary
  high_level_summary: true  # TÃ³m táº¯t tá»•ng quan vá» PR

  # Poem - táº¯t thÆ¡ Ä‘i cho Ä‘á»¡ spam :)
  poem: false

  # Review status - comment tá»•ng káº¿t
  review_status: true

  # Collapse walkthrough
  collapse_walkthrough: false  # true = thu gá»n pháº§n walkthrough

  # Auto review
  auto_review:
    enabled: true  # Báº­t auto review
    drafts: false  # KhÃ´ng review draft PRs
    base_branches:
      - dev
      - main
      - master

  # Path filters - chá»‰ review nhá»¯ng file nÃ y
  path_filters:
    - "!**/*.md"  # KhÃ´ng review markdown files
    - "!**/package-lock.json"  # KhÃ´ng review lock files
    - "!**/yarn.lock"
    - "!**/*.min.js"  # KhÃ´ng review minified files
    - "src/**/*"  # Review táº¥t cáº£ trong src/

  # Path instructions - custom instructions cho tá»«ng loáº¡i file
  path_instructions:
    - path: "**/*.test.ts"
      instructions: |
        Chá»‰ review logic test, khÃ´ng cáº§n quÃ¡ chi tiáº¿t vá» code style.
        Focus vÃ o test coverage vÃ  edge cases.

    - path: "**/*.tsx"
      instructions: |
        Review React components:
        - Performance (useMemo, useCallback)
        - Accessibility
        - Props typing
        - Component structure

    - path: "**/*.ts"
      instructions: |
        Review TypeScript code:
        - Type safety
        - Naming conventions
        - Error handling
        - Code organization

  # Abort on close - dá»«ng review náº¿u PR bá»‹ Ä‘Ã³ng
  abort_on_close: true

  # Tools - cÃ¡c cÃ´ng cá»¥ CodeRabbit sá»­ dá»¥ng
  tools:
    shellcheck:
      enabled: true  # Review bash scripts

    ruff:
      enabled: false  # Python linter (táº¯t náº¿u khÃ´ng dÃ¹ng Python)

    markdownlint:
      enabled: false  # KhÃ´ng check markdown

    biome:
      enabled: true  # JS/TS linter

    hadolint:
      enabled: true  # Dockerfile linter

# Chat settings
chat:
  auto_reply: true  # Tá»± Ä‘á»™ng reply khi Ä‘Æ°á»£c tag

# Knowledge base - custom knowledge cho project
knowledge_base:
  - "ÄÃ¢y lÃ  React TypeScript project"
  - "Sá»­ dá»¥ng Vite lÃ m build tool"
  - "Code style: functional components, hooks"
  - "Prefer TypeScript strict mode"
  - "Sá»­ dá»¥ng ESLint vÃ  Prettier"

# Custom prompts - Review nhÆ° Senior React Developer
custom_prompts:
  - prompt: |
      Báº¡n lÃ  Senior Front-end Developer chuyÃªn vá» React/TypeScript. Khi review code, hÃ£y Ä‘áº·c biá»‡t chÃº Ã½:

      ## ğŸ”´ CRITICAL - Pháº£i fix ngay:
      1. **Security vulnerabilities**
         - XSS, CSRF attacks
         - Exposed sensitive data (API keys, tokens)
         - Unsafe dangerouslySetInnerHTML
         - Missing input validation

      2. **Performance killers**
         - Missing React.memo cho heavy components
         - KhÃ´ng dÃ¹ng useCallback/useMemo khi cáº§n thiáº¿t
         - Infinite loops trong useEffect
         - Memory leaks (missing cleanup)
         - Unnecessary re-renders

      3. **Type safety issues**
         - Any types trong TypeScript
         - Missing prop types
         - Unsafe type assertions (as any)

      ## ğŸŸ¡ IMPORTANT - NÃªn fix:
      4. **React Best Practices**
         - Component quÃ¡ lá»›n (> 300 lines) â†’ cáº§n split
         - Logic phá»©c táº¡p nÃªn tÃ¡ch ra custom hooks
         - Props drilling sÃ¢u â†’ dÃ¹ng Context hoáº·c state management
         - Missing key props trong lists
         - Side effects trong render
         - KhÃ´ng handle loading/error states

      5. **Code Organization**
         - File structure khÃ´ng rÃµ rÃ ng
         - TÃªn biáº¿n/function khÃ´ng descriptive
         - Magic numbers/strings â†’ nÃªn dÃ¹ng constants
         - Code duplication â†’ táº¡o reusable components/utils
         - Missing JSDoc comments cho complex logic

      6. **Accessibility (a11y)**
         - Missing alt text cho images
         - KhÃ´ng dÃ¹ng semantic HTML
         - Missing ARIA labels
         - Keyboard navigation issues

      7. **Error Handling**
         - Try-catch cho async operations
         - Error boundaries cho components
         - Graceful degradation
         - User-friendly error messages

      ## ğŸŸ¢ NICE TO HAVE - Gá»£i Ã½ cáº£i thiá»‡n:
      8. **Modern React Patterns**
         - Sá»­ dá»¥ng hooks thay vÃ¬ class components
         - Composition over inheritance
         - Render props pattern khi phÃ¹ há»£p
         - Compound components pattern

      9. **Code Style & Consistency**
         - Consistent naming conventions (camelCase, PascalCase)
         - Component file naming (PascalCase.tsx)
         - Consistent import ordering
         - ESLint/Prettier compliance

      10. **Testing Considerations**
          - Code cÃ³ testable khÃ´ng?
          - Missing test cases cho edge cases
          - Mocking dependencies Ä‘Ãºng cÃ¡ch

      11. **Bundle Size & Optimization**
          - Tree-shaking opportunities
          - Lazy loading components
          - Code splitting strategies
          - Dynamic imports

      ## Format Review Comments:
      Khi comment, sá»­ dá»¥ng format:

      **[Má»¨C Äá»˜] Váº¥n Ä‘á»**
      - Giáº£i thÃ­ch táº¡i sao Ä‘Ã¢y lÃ  váº¥n Ä‘á»
      - Impact: áº£nh hÆ°á»Ÿng nhÆ° tháº¿ nÃ o
      - Suggestion: cÃ¡ch fix cá»¥ thá»ƒ vá»›i code example

      VÃ­ dá»¥:
      ```
      **[CRITICAL] Missing dependency trong useEffect**

      Current code sáº½ gÃ¢y ra stale closure, `userId` luÃ´n lÃ  giÃ¡ trá»‹ ban Ä‘áº§u.

      Impact: Data khÃ´ng Ä‘Æ°á»£c fetch láº¡i khi userId thay Ä‘á»•i â†’ user tháº¥y wrong data

      Suggestion:
      ```typescript
      useEffect(() => {
        fetchUserData(userId);
      }, [userId]); // ThÃªm userId vÃ o dependency array
      ```
      ```

      ## Khi code Tá»T, hÃ£y khen:
      - "âœ… Good job! Viá»‡c sá»­ dá»¥ng useMemo á»Ÿ Ä‘Ã¢y giÃºp trÃ¡nh re-calculation khÃ´ng cáº§n thiáº¿t"
      - "ğŸ‘ Clean component structure, dá»… Ä‘á»c vÃ  maintain"
      - "ğŸ¯ Perfect! Error boundary nÃ y sáº½ prevent app crashes"
